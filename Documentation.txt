


    /**
     * Called for each item published.
     */
    void onNext(T item);

    /**
     * Called when an unrecoverable error occurs.
     * No further calls will be made after this.
     */
    void onError(Throwable throwable);

    /**
     * Called when no more items will be published.
     * No further calls will be made after this.
     */
    void onComplete();
}

/**
 * Represents the relationship between a Publisher and a Subscriber.
 * Controls demand (backpressure) and cancellation.
 */
public interface Subscription {
    /**
     * Request n more items from the Publisher.
     * n must be > 0, otherwise onError may be called.
     * To request unbounded, use Long.MAX_VALUE.
     */
    void request(long n);

    /**
     * Cancel the subscription. No more items will be sent.
     */
    void cancel();
}

/**
 * Processor = Publisher + Subscriber combined (can be used in the middle of chains)
 */
public interface Processor<T, R> extends Subscriber<T>, Publisher<R> {
    // No additional methods â€” it's just the combination
}





Client (your code)                  Publisher                  Subscriber (your instance)
    |                                 |                             |
    | 1. Creates Publisher            |                             |
    |  |                              |                             |
    | 2. Creates Subscriber           |                             |
    |  |                              |                             |
    | 3. Calls publisher.subscribe(subscriber)                     |
    |--------------------------------->                             |
    |                                 |                             |
    |                                 | 4. SYNCHRONOUSLY calls      |
    |                                 |    subscriber.onSubscribe(  |
    |                                 |        new Subscription() ) |
    |                                 |---------------------------->|
    |                                 |                             | 5. Receives Subscription
    |                                 |                             |    object
    |                                 |                             |
    |                                 |                             | 6. Calls subscription.request(n)
    |                                 |<----------------------------|
    |                                 |                             |
    |                                 | 7. Publisher's async process|
    |                                 |    starts (e.g., background |
    |                                 |    thread or async task)    |
    |                                 |                             |
    |                                 | 8. Calls subscriber.onNext(item)
    |                                 |---------------------------->|
    |                                 |                             | 9. Receives item
    |                                 |                             |
    |                                 | 10. Calls onNext again...   |
    |                                 |---------------------------->|
    |                                 |                             |
    |                                 | 11. Calls subscriber.onComplete()
    |                                 |---------------------------->|
    |                                 |                             | 12. Stream complete




========================

IntPub  <-> Processor <-> Subscriber -> Subscription.

Subscription.request();

Processor.Publisher.request()
IntPub.request()

IntPub.onNext()
IntPut.complete()

Processor.Subscriber.onNext()
Processor.Subscriber.complete()

Subscriber.onNext()
Subscriber.complete()

================


sequenceDiagram
    ProcessorClient->>+FlowResultImpl: subscribe
    FlowResultImpl->>+IntegerPublisher: onSubscribe
    IntegerPublisher->>+MappingFunctionProcessor: onSubscribe
    MappingFunctionProcessor->>-SystemOutSubscriber: onSubscribe
    SystemOutSubscriber-->>+IntegerPublisher: request
    IntegerPublisher->>-FlowResultImpl: onNext
    FlowResultImpl->>+MappingFunctionProcessor: onNext
    MappingFunctionProcessor-->>+SystemOutSubscriber: onNext


sequenceDiagram
    participant Client as ProcessorClient (run3)
    participant RP as resultPublisher (Lambda in FlowResultImpl)
    participant MFP as MappingFunctionProcessor
    participant IP as IntegerPublisher
    participant SOS as SystemOutSubscriber

    Note over Client, SOS: resultPublisher.subscribe(new SystemOutSubscriber(...))
    Client->>RP: subscribe(SystemOutSubscriber)
    
    Note over RP: Inside FlowResultImpl Lambda
    RP->>MFP: new MappingFunctionProcessor(mappingFunction)
    RP->>MFP: subscribe(SystemOutSubscriber)
    Note right of MFP: downstream = SystemOutSubscriber
    
    RP->>IP: subscribe(MappingFunctionProcessor)
    
    Note over IP: Inside IntegerPublisher
    IP->>MFP: onSubscribe(Subscription)
    MFP->>SOS: onSubscribe(Subscription)
    
    Note over SOS: SOS requests data
    SOS->>IP: subscription.request(Long.MAX_VALUE)
    
    Note over IP: Async Execution in Thread Pool
    loop for each item in list
        IP->>MFP: onNext(Integer)
        Note right of MFP: mapper.apply(item)
        MFP->>SOS: onNext(T)
    end
    
    IP->>MFP: onComplete()
    MFP->>SOS: onComplete()


